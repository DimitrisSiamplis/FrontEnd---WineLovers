{"ast":null,"code":"import _slicedToArray from\"C:/Users/dimitris.siamplis/Desktop/React-Node/Front-End/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React from\"react\";import{Button,Row,Form,Modal,Col,Alert,Spinner}from\"react-bootstrap\";import{useState}from\"react\";import{BiLogIn}from\"react-icons/bi\";import\"./Login.css\";import Cookies from\"universal-cookie\";import{AiOutlineMail}from\"react-icons/ai\";import emailjs from\"@emailjs/browser\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Login=function Login(props){var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),email=_useState2[0],setEmail=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),password=_useState4[0],setPassword=_useState4[1];var _useState5=useState(true),_useState6=_slicedToArray(_useState5,2),testLogin=_useState6[0],setTestLogin=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),show=_useState8[0],setShow=_useState8[1];var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),forgotPasswordEmail=_useState10[0],setForgotPasswordEmail=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),successfullyChanged=_useState12[0],setSuccessfullyChanged=_useState12[1];var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),errorChanged=_useState14[0],setErrorChanged=_useState14[1];var _useState15=useState(\"\"),_useState16=_slicedToArray(_useState15,2),newPassword=_useState16[0],setNewPassword=_useState16[1];var _useState17=useState(false),_useState18=_slicedToArray(_useState17,2),activeSpinner=_useState18[0],setActiveSpinner=_useState18[1];var handleClose=function handleClose(){return setShow(false);};var handleShow=function handleShow(){return setShow(true);};var onTriger=function onTriger(email){props.handleCallback(email);};var isLogin=function isLogin(){setActiveSpinner(true);var userDetails={email:email,password:password};fetch(\"https://winelovers.herokuapp.com/login\",{method:\"POST\",body:JSON.stringify(userDetails),headers:{\"Content-Type\":\"application/json\"}}).then(function(res){return res.json();}).then(function(json){setActiveSpinner(false);if(json.status===true){setTestLogin(true);var cookies=new Cookies();cookies.set(\"email\",json.email,{path:\"/\"});console.log(cookies.get(\"email\"));onTriger(json.email);}else{alert(\"Error logim\");setTestLogin(false);}});};//--------------- Email Validation ----------------------\nvar validateEmail=function validateEmail(email){return String(email).toLowerCase().match(/^(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/);};// ---------------------- Send Email ----------------\nvar SendEmail=function SendEmail(newPass){emailjs.send(\"service_v0wulhc\",\"template_c3rq3x4\",{new_password:newPass,email_to:forgotPasswordEmail},\"WuMNYncc27nq1KILD\").then(function(res){setSuccessfullyChanged(true);setForgotPasswordEmail(\"\");});};// ----------------- Forgot password chech --------------------\nvar forgotPassword=function forgotPassword(){setSuccessfullyChanged(false);setErrorChanged(false);var newPass=Math.random().toString(36).slice(-10);setNewPassword(newPass);var userDetails={email:forgotPasswordEmail,new_password:newPass};// fetch(\"https://winelovers.herokuapp.com/forgotPassword\", {\nfetch(\"https://winelovers.herokuapp.com/forgotPassword\",{method:\"POST\",body:JSON.stringify(userDetails),headers:{\"Content-Type\":\"application/json\"}}).then(function(res){return res.json();}).then(function(json){console.log(json.status);if(json.status){SendEmail(newPass);}else{setErrorChanged(true);}});};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(Modal,{show:show,onHide:handleClose,size:\"xl\",children:[/*#__PURE__*/_jsx(Modal.Header,{closeButton:true,children:/*#__PURE__*/_jsx(Modal.Title,{children:\"Forgot your password ?\"})}),/*#__PURE__*/_jsx(Modal.Body,{className:\"forgot-password-box\",children:/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{xs:6,children:/*#__PURE__*/_jsx(\"img\",{className:\"forgot-password-image\",src:\"https://media.istockphoto.com/photos/celebration-pictMure-id160836693?k=20&m=160836693&s=612x612&w=0&h=tcihQ6c3JvKOQkZ2g-IBFByE5RmB227QnWi6xpwzlqs=\"})}),/*#__PURE__*/_jsxs(Col,{xs:6,className:\"forgot-password-container\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Trouble logging in?\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"p\",{children:\"Type your email address and we'll send you a new password.\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(Form.Control,{type:\"search\",value:forgotPasswordEmail,placeholder:\"Enter email\",onChange:function onChange(e){setForgotPasswordEmail(e.target.value);}}),!validateEmail(forgotPasswordEmail)&&/*#__PURE__*/_jsxs(\"p\",{className:\"forgot-password-error-message\",children:[\"Wrong email address.\",\" \"]}),/*#__PURE__*/_jsx(\"br\",{}),successfullyChanged&&/*#__PURE__*/_jsxs(Alert,{variant:\"success\",children:[\" \",/*#__PURE__*/_jsx(AiOutlineMail,{className:\"history-icon\"}),\" Your Password successfully changed! Please check your email address .\",\" \"]}),errorChanged&&/*#__PURE__*/_jsxs(Alert,{variant:\"danger\",children:[\" \",/*#__PURE__*/_jsx(AiOutlineMail,{className:\"history-icon\"}),\" Your email address is incorect! Try again!\",\" \"]})]})]})})}),/*#__PURE__*/_jsxs(Modal.Footer,{children:[/*#__PURE__*/_jsx(Button,{variant:\"secondary\",onClick:handleClose,children:\"Close\"}),/*#__PURE__*/_jsx(Button,{disabled:!validateEmail(forgotPasswordEmail),variant:\"primary\",onClick:function onClick(){//handleClose()\nforgotPassword();//SendEmail();\n},children:\"Reset Password\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"loginCard\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"login-text\",children:[/*#__PURE__*/_jsx(\"h1\",{children:/*#__PURE__*/_jsx(BiLogIn,{})}),/*#__PURE__*/_jsx(\"p\",{className:\"login-text-decoration\",children:\"Login\"})]}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsxs(Form,{children:[/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",controlId:\"formBasicEmail\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Email address\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"email\",value:email,placeholder:\"Enter email\",onChange:function onChange(e){setEmail(e.target.value);}}),/*#__PURE__*/_jsx(Form.Text,{className:\"text-muted\",children:\"We'll never share your email with anyone else.\"}),email.length>0&&email.length<5&&/*#__PURE__*/_jsx(\"p\",{className:\"alertMessage\",children:\"Email must include at least 5 characters!\"}),!testLogin&&/*#__PURE__*/_jsx(\"p\",{className:\"alertMessage\",children:\"Email or Password are incorect!Try again!\"})]}),/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",controlId:\"formBasicPassword\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Password\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"password\",placeholder:\"Password\",value:password,onKeyDown:function onKeyDown(e){if(e.key===\"Enter\"){e.preventDefault();isLogin();}},onChange:function onChange(e){setPassword(e.target.value);}})]}),activeSpinner&&/*#__PURE__*/_jsxs(Row,{className:\"d-flex justify-content-center\",children:[/*#__PURE__*/_jsx(Spinner,{animation:\"border\",variant:\"primary\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{})]}),/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Button,{variant:\"primary\",onClick:isLogin,disabled:email===\"\"||password===\"\"||email.length<5,children:\"Submit\"})}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"div\",{className:\"texts-under-login\",children:/*#__PURE__*/_jsx(\"p\",{onClick:function onClick(){handleShow();},className:\"forgot-password-text\",children:\"Forgot your password?\"})})]})]})]});};export default Login;","map":{"version":3,"sources":["C:/Users/dimitris.siamplis/Desktop/React-Node/Front-End/src/Components/Login.js"],"names":["React","Button","Row","Form","Modal","Col","Alert","Spinner","useState","BiLogIn","Cookies","AiOutlineMail","emailjs","Login","props","email","setEmail","password","setPassword","testLogin","setTestLogin","show","setShow","forgotPasswordEmail","setForgotPasswordEmail","successfullyChanged","setSuccessfullyChanged","errorChanged","setErrorChanged","newPassword","setNewPassword","activeSpinner","setActiveSpinner","handleClose","handleShow","onTriger","handleCallback","isLogin","userDetails","fetch","method","body","JSON","stringify","headers","then","res","json","status","cookies","set","path","console","log","get","alert","validateEmail","String","toLowerCase","match","SendEmail","newPass","send","new_password","email_to","forgotPassword","Math","random","toString","slice","e","target","value","length","key","preventDefault"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport { Button, Row, Form, Modal, Col, Alert, Spinner } from \"react-bootstrap\";\r\nimport { useState } from \"react\";\r\nimport { BiLogIn } from \"react-icons/bi\";\r\nimport \"./Login.css\";\r\nimport Cookies from \"universal-cookie\";\r\nimport { AiOutlineMail } from \"react-icons/ai\";\r\nimport emailjs from \"@emailjs/browser\";\r\n\r\nconst Login = (props) => {\r\n  const [email, setEmail] = useState(\"\");\r\n  const [password, setPassword] = useState(\"\");\r\n  const [testLogin, setTestLogin] = useState(true);\r\n  const [show, setShow] = useState(false);\r\n\r\n  const [forgotPasswordEmail, setForgotPasswordEmail] = useState(\"\");\r\n  const [successfullyChanged, setSuccessfullyChanged] = useState(false);\r\n  const [errorChanged, setErrorChanged] = useState(false);\r\n  const [newPassword, setNewPassword] = useState(\"\");\r\n\r\n  const [activeSpinner, setActiveSpinner] = useState(false);\r\n\r\n  const handleClose = () => setShow(false);\r\n  const handleShow = () => setShow(true);\r\n\r\n  const onTriger = (email) => {\r\n    props.handleCallback(email);\r\n  };\r\n\r\n  const isLogin = () => {\r\n    setActiveSpinner(true);\r\n    let userDetails = {\r\n      email: email,\r\n      password: password,\r\n    };\r\n    fetch(\"https://winelovers.herokuapp.com/login\", {\r\n      method: \"POST\",\r\n      body: JSON.stringify(userDetails),\r\n      headers: { \"Content-Type\": \"application/json\" },\r\n    })\r\n      .then((res) => res.json())\r\n      .then((json) => {\r\n        setActiveSpinner(false);\r\n        if (json.status === true) {\r\n          setTestLogin(true);\r\n          const cookies = new Cookies();\r\n          cookies.set(\"email\", json.email, { path: \"/\" });\r\n          console.log(cookies.get(\"email\"));\r\n          onTriger(json.email);\r\n        } else {\r\n          alert(\"Error logim\");\r\n          setTestLogin(false);\r\n        }\r\n      });\r\n  };\r\n\r\n  //--------------- Email Validation ----------------------\r\n  const validateEmail = (email) => {\r\n    return String(email)\r\n      .toLowerCase()\r\n      .match(\r\n        /^(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/\r\n      );\r\n  };\r\n\r\n  // ---------------------- Send Email ----------------\r\n\r\n  const SendEmail = (newPass) => {\r\n    emailjs\r\n      .send(\r\n        \"service_v0wulhc\",\r\n        \"template_c3rq3x4\",\r\n        {\r\n          new_password: newPass,\r\n          email_to: forgotPasswordEmail,\r\n        },\r\n        \"WuMNYncc27nq1KILD\"\r\n      )\r\n      .then(function (res) {\r\n        setSuccessfullyChanged(true);\r\n        setForgotPasswordEmail(\"\");\r\n      });\r\n  };\r\n\r\n  // ----------------- Forgot password chech --------------------\r\n  const forgotPassword = () => {\r\n    setSuccessfullyChanged(false);\r\n    setErrorChanged(false);\r\n    var newPass = Math.random().toString(36).slice(-10);\r\n    setNewPassword(newPass);\r\n    let userDetails = {\r\n      email: forgotPasswordEmail,\r\n      new_password: newPass,\r\n    };\r\n    // fetch(\"https://winelovers.herokuapp.com/forgotPassword\", {\r\n    fetch(\"https://winelovers.herokuapp.com/forgotPassword\", {\r\n      method: \"POST\",\r\n      body: JSON.stringify(userDetails),\r\n      headers: { \"Content-Type\": \"application/json\" },\r\n    })\r\n      .then((res) => res.json())\r\n      .then((json) => {\r\n        console.log(json.status);\r\n        if (json.status) {\r\n          SendEmail(newPass);\r\n        } else {\r\n          setErrorChanged(true);\r\n        }\r\n      });\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <Modal show={show} onHide={handleClose} size=\"xl\">\r\n        <Modal.Header closeButton>\r\n          <Modal.Title>Forgot your password ?</Modal.Title>\r\n        </Modal.Header>\r\n        <Modal.Body className=\"forgot-password-box\">\r\n          <div>\r\n            <Row>\r\n              <Col xs={6}>\r\n                <img\r\n                  className=\"forgot-password-image\"\r\n                  src=\"https://media.istockphoto.com/photos/celebration-pictMure-id160836693?k=20&m=160836693&s=612x612&w=0&h=tcihQ6c3JvKOQkZ2g-IBFByE5RmB227QnWi6xpwzlqs=\"\r\n                ></img>\r\n              </Col>\r\n              <Col xs={6} className=\"forgot-password-container\">\r\n                <h3>Trouble logging in?</h3>\r\n                <br />\r\n                <p>\r\n                  Type your email address and we'll send you a new password.\r\n                </p>\r\n                <br />\r\n\r\n                <Form.Control\r\n                  type=\"search\"\r\n                  value={forgotPasswordEmail}\r\n                  placeholder=\"Enter email\"\r\n                  onChange={(e) => {\r\n                    setForgotPasswordEmail(e.target.value);\r\n                  }}\r\n                />\r\n                {!validateEmail(forgotPasswordEmail) && (\r\n                  <p className=\"forgot-password-error-message\">\r\n                    Wrong email address.{\" \"}\r\n                  </p>\r\n                )}\r\n                <br />\r\n                {successfullyChanged && (\r\n                  <Alert variant=\"success\">\r\n                    {\" \"}\r\n                    <AiOutlineMail className=\"history-icon\" /> Your Password\r\n                    successfully changed! Please check your email address .{\" \"}\r\n                  </Alert>\r\n                )}\r\n\r\n                {errorChanged && (\r\n                  <Alert variant=\"danger\">\r\n                    {\" \"}\r\n                    <AiOutlineMail className=\"history-icon\" /> Your email\r\n                    address is incorect! Try again!{\" \"}\r\n                  </Alert>\r\n                )}\r\n              </Col>\r\n            </Row>\r\n          </div>\r\n        </Modal.Body>\r\n        <Modal.Footer>\r\n          <Button variant=\"secondary\" onClick={handleClose}>\r\n            Close\r\n          </Button>\r\n          <Button\r\n            disabled={!validateEmail(forgotPasswordEmail)}\r\n            variant=\"primary\"\r\n            onClick={() => {\r\n              //handleClose()\r\n              forgotPassword();\r\n              //SendEmail();\r\n            }}\r\n          >\r\n            Reset Password\r\n          </Button>\r\n        </Modal.Footer>\r\n      </Modal>\r\n      <div className=\"loginCard\">\r\n        <div className=\"login-text\">\r\n          <h1>\r\n            <BiLogIn />\r\n          </h1>\r\n          <p className=\"login-text-decoration\">Login</p>\r\n        </div>\r\n\r\n        <hr />\r\n\r\n        <Form>\r\n          <Form.Group className=\"mb-3\" controlId=\"formBasicEmail\">\r\n            <Form.Label>Email address</Form.Label>\r\n            <Form.Control\r\n              type=\"email\"\r\n              value={email}\r\n              placeholder=\"Enter email\"\r\n              onChange={(e) => {\r\n                setEmail(e.target.value);\r\n              }}\r\n            />\r\n            <Form.Text className=\"text-muted\">\r\n              We'll never share your email with anyone else.\r\n            </Form.Text>\r\n            {email.length > 0 && email.length < 5 && (\r\n              <p className=\"alertMessage\">\r\n                Email must include at least 5 characters!\r\n              </p>\r\n            )}\r\n            {!testLogin && (\r\n              <p className=\"alertMessage\">\r\n                Email or Password are incorect!Try again!\r\n              </p>\r\n            )}\r\n          </Form.Group>\r\n\r\n          <Form.Group className=\"mb-3\" controlId=\"formBasicPassword\">\r\n            <Form.Label>Password</Form.Label>\r\n            <Form.Control\r\n              type=\"password\"\r\n              placeholder=\"Password\"\r\n              value={password}\r\n              onKeyDown={(e) => {\r\n                if (e.key === \"Enter\") {\r\n                  e.preventDefault();\r\n                  isLogin();\r\n                }\r\n              }}\r\n              onChange={(e) => {\r\n                setPassword(e.target.value);\r\n              }}\r\n            />\r\n          </Form.Group>\r\n          {activeSpinner && (\r\n            <Row className=\"d-flex justify-content-center\">\r\n              <Spinner animation=\"border\" variant=\"primary\" />\r\n              <br /><br />\r\n            </Row>\r\n          )}\r\n\r\n          <Row>\r\n            <Button\r\n              variant=\"primary\"\r\n              onClick={isLogin}\r\n              disabled={email === \"\" || password === \"\" || email.length < 5}\r\n            >\r\n              Submit\r\n            </Button>\r\n          </Row>\r\n          <br />\r\n          <div className=\"texts-under-login\">\r\n            <p\r\n              onClick={() => {\r\n                handleShow();\r\n              }}\r\n              className=\"forgot-password-text\"\r\n            >\r\n              Forgot your password?\r\n            </p>\r\n          </div>\r\n        </Form>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Login;\r\n"]},"metadata":{},"sourceType":"module"}