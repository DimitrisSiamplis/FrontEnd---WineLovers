{"ast":null,"code":"import _slicedToArray from\"C:/Users/dimitris.siamplis/Desktop/React-Node/Front-End/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React from\"react\";import\"./Card.css\";import{useState,useEffect}from\"react\";import Cookies from\"universal-cookie\";import{FontAwesomeIcon}from\"@fortawesome/react-fontawesome\";import{faTrash}from\"@fortawesome/free-solid-svg-icons\";import{Alert}from\"react-bootstrap\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Card=function Card(){var _useState=useState(0),_useState2=_slicedToArray(_useState,2),totalPrice=_useState2[0],setTotalPrice=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),kindPayment=_useState4[0],setKindPayment=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),address=_useState6[0],setAddress=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),phoneNum=_useState8[0],setPhoneNum=_useState8[1];var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),zipCode=_useState10[0],setZipCode=_useState10[1];var _useState11=useState([]),_useState12=_slicedToArray(_useState11,2),userDetails=_useState12[0],setUseretails=_useState12[1];var _useState13=useState(\"\"),_useState14=_slicedToArray(_useState13,2),cardNumber=_useState14[0],setCardNumber=_useState14[1];var _useState15=useState(\"\"),_useState16=_slicedToArray(_useState15,2),cardDate=_useState16[0],setCardDate=_useState16[1];var _useState17=useState(\"\"),_useState18=_slicedToArray(_useState17,2),cardCVV=_useState18[0],setCardCVV=_useState18[1];var cookies=new Cookies();var userEmail=cookies.get(\"email\");console.log(cookies.get(\"card\"));// ------------ Get user Details -----------------\nvar getUser=function getUser(){fetch(\"http://localhost:4000/getUser/\".concat(userEmail)).then(function(res){return res.json();}).then(function(json){console.log(json.user);setAddress(json.user.Address);setPhoneNum(json.user.Mobile);setUseretails([json]);});};useEffect(function(){getUser();},[]);var cardDetails=cookies.get(\"card\")===\"\"||cookies.get(\"card\")===undefined?[]:cookies.get(\"card\").split(\"|\");var _useState19=useState(cardDetails),_useState20=_slicedToArray(_useState19,2),card=_useState20[0],setCard=_useState20[1];// -------- Delete from Card ----------\nvar onDeletefromCard=function onDeletefromCard(item){var cardCookies=cookies.get(\"card\");var cardArray=cardCookies.split(\"|\");cardArray=cardArray.filter(function(word){return word!==item;});if(cardArray===[\"\"]){cookies.remove(\"card\");// cookies.set(\"card\", undefined , { path: \"/\" });\nsetCard([]);}else{cookies.set(\"card\",cardArray.join(\"|\"),{path:\"/\"});setCard(cardArray);}};useEffect(function(){if(card.length===0){setTotalPrice(0);}else{var total_price=0;for(var key in card){total_price=Number(total_price)+Number(card[key].split(\",\")[5]*card[key].split(\",\")[7]);}setTotalPrice(total_price);}},[card]);var onCreateOrder=function onCreateOrder(){var wineList=[];for(var key in card){wineList.push(card[key].split(\",\")[0]);}// console.log(totalPrice);\n// console.log(userEmail);\n// console.log(wineList)\nvar cardDetails={wineList:wineList,email:userEmail,totalPrice:totalPrice};fetch(\"http://localhost:4000/completeOrder\",{method:\"POST\",body:JSON.stringify(cardDetails),headers:{\"Content-Type\":\"application/json\"}}).then(function(res){return res.json();}).then(function(json){console.log(json);cookies.remove(\"card\");setCard([]);});};return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"cardboth\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"product-details mr-2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex flex-row align-items-center\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-long-arrow-left\"}),/*#__PURE__*/_jsx(\"button\",{//   style=\"padding: 0; border: none; background: none;\"\nclassName:\"ml-2\",children:\"Continue Shopping\"})]}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsx(\"h6\",{className:\"mb-0\",children:\"Shopping cart\"}),card.length===0&&/*#__PURE__*/_jsx(Alert,{className:\"emptyAlert\",variant:\"warning\",children:\"The Card is Empty!\"}),card.length!==0&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between\",children:[/*#__PURE__*/_jsxs(\"span\",{children:[\"You have \",/*#__PURE__*/_jsxs(\"strong\",{children:[card.length,\" items\"]}),\" in your cart\"]}),/*#__PURE__*/_jsxs(\"strong\",{children:[\"Total Price : \",totalPrice,\" \\u20AC\"]})]}),card.map(function(item){return/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between align-items-center mt-3 p-2 items rounded\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex flex-row\",children:[/*#__PURE__*/_jsx(\"a\",{href:\"/wine/\".concat(item.split(\",\")[0]),children:/*#__PURE__*/_jsx(\"img\",{className:\"cardImage\",src:item.split(\",\")[6],width:\"40\"})}),\"\\xA0\\xA0\\xA0\\xA0\\xA0\\xA0\\xA0\",/*#__PURE__*/_jsxs(\"div\",{className:\"ml-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-weight-bold d-block\",children:item.split(\",\")[1]}),/*#__PURE__*/_jsxs(\"span\",{className:\"spec\",children:[item.split(\",\")[4],\" , \",item.split(\",\")[3]]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex flex-row align-items-center\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"d-block\",children:\"\\xA0\\xA0\\xA0\"}),\" \",\"\\xA0 \",/*#__PURE__*/_jsx(\"span\",{className:\"d-block\",children:item.split(\",\")[7]}),/*#__PURE__*/_jsx(\"strong\",{children:\"\\xA0 x \\xA0\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"d-block ml-5 font-weight-bold\",children:[item.split(\",\")[5],\"\\xA0 = \\xA0\"]}),/*#__PURE__*/_jsxs(\"span\",{className:\"d-block ml-5 font-weight-bold\",children:[/*#__PURE__*/_jsxs(\"strong\",{children:[item.split(\",\")[7]*item.split(\",\")[5],\" \\xA0\\u20AC\"]}),\"\\xA0\\xA0\\xA0\\xA0\\xA0\",/*#__PURE__*/_jsx(FontAwesomeIcon,{className:\"deleteIcon\",onClick:function onClick(){onDeletefromCard(item);},icon:faTrash,size:\"1x\"})]})]})]});})]})]}),userDetails.length!==0&&/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-2\",children:[/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),\"Continue with Order\",/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"div\",{className:\"payment-info\",children:[\"Personal Details\",/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"credit-card-label\",children:\"Shipping location\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:address,className:\"form-control credit-inputs\",placeholder:\"Atiki,Greece 31\",onChange:function onChange(e){setAddress(e.target.value);}})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"credit-card-label\",children:\"Zip Number\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control credit-inputs\",placeholder:\"15231\",onChange:function onChange(e){setZipCode(e.target.value);}})]}),zipCode!==\"\"&&zipCode.length!==5&&/*#__PURE__*/_jsx(\"p\",{className:\"alertMessage\",children:\"Wrong Zip Code. Max length 5.\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"credit-card-label\",children:\"Phone Number\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:phoneNum,className:\"form-control credit-inputs\",placeholder:\"6999999999\",onChange:function onChange(e){setPhoneNum(e.target.value);}})]}),phoneNum!==\"\"&&(isNaN(phoneNum)||phoneNum.length>10||phoneNum.length<10)&&/*#__PURE__*/_jsx(\"p\",{className:\"alertMessage\",children:\"Wrong Phone Number\"})]}),/*#__PURE__*/_jsx(\"hr\",{className:\"line\"}),\"Kind of Payment\",/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"credit-card-label\",children:\"Name on card\"}),/*#__PURE__*/_jsxs(\"select\",{className:\"form-control credit-inputs\",onChange:function onChange(e){setKindPayment(e.target.value);},children:[/*#__PURE__*/_jsx(\"option\",{value:\"delivery\",children:\"Pay on delivery\"}),/*#__PURE__*/_jsx(\"option\",{value:\"deposit\",children:\"Bank deposit\"}),/*#__PURE__*/_jsx(\"option\",{value:\"card\",children:\"Payment by card\"})]})]}),kindPayment===\"card\"&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"hr\",{className:\"line\"}),\"Card Details\",/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"credit-card-label\",children:\"Card number\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control credit-inputs\"// maxLength=\"19\"\n,value:cardNumber,onChange:function onChange(e){console.log(e.target.value.length);if((!isNaN(e.target.value[e.target.value.length-1])||e.target.value===\"\")&&e.target.value.length<16){setCardNumber(e.target.value);}}})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"credit-card-label\",children:\"Date\"}),/*#__PURE__*/_jsx(\"input\",{type:\"search\",value:cardDate.length==2?cardDate.slice(0,2)+\"/\":cardDate,className:\"form-control credit-inputs\",placeholder:\"12/24\",onChange:function onChange(e){if(e.target.value.length<6){var testArray=e.target.value.split(\"/\");var newEtargetValue=\"\";for(var key in testArray){newEtargetValue=newEtargetValue+testArray[key];}console.log(newEtargetValue);if(!isNaN(newEtargetValue)){setCardDate(e.target.value);}}}})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"credit-card-label\",children:\"CVV\"}),/*#__PURE__*/_jsx(\"input\",{type:\"search\",className:\"form-control credit-inputs\",placeholder:\"342\",value:cardCVV,onChange:function onChange(e){if(!isNaN(e.target.value)&&e.target.value.length<4){setCardCVV(e.target.value);}}})]})]})]}),/*#__PURE__*/_jsx(\"hr\",{className:\"line\"}),\"Sumary\",/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between information\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Subtotal\"}),/*#__PURE__*/_jsxs(\"span\",{children:[\" \",totalPrice,\" \\u20AC\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between information\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Shipping\"}),/*#__PURE__*/_jsx(\"span\",{children:totalPrice>50||totalPrice===0?\"0 €\":\"3 €\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between information\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Total(Incl. taxes)\"}),/*#__PURE__*/_jsxs(\"span\",{children:[totalPrice>50||totalPrice===0?totalPrice:totalPrice+3,\" \",\"\\u20AC\"]})]}),/*#__PURE__*/_jsx(\"button\",{disabled:card.length===0,onClick:onCreateOrder,className:\"btn btn-primary btn-block d-flex justify-content-between mt-3\",children:/*#__PURE__*/_jsxs(\"span\",{children:[\"Complete Order\",/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-long-arrow-right ml-1\"})]})})]})]})]})});};export default Card;","map":{"version":3,"sources":["C:/Users/dimitris.siamplis/Desktop/React-Node/Front-End/src/pages/Card.js"],"names":["React","useState","useEffect","Cookies","FontAwesomeIcon","faTrash","Alert","Card","totalPrice","setTotalPrice","kindPayment","setKindPayment","address","setAddress","phoneNum","setPhoneNum","zipCode","setZipCode","userDetails","setUseretails","cardNumber","setCardNumber","cardDate","setCardDate","cardCVV","setCardCVV","cookies","userEmail","get","console","log","getUser","fetch","then","res","json","user","Address","Mobile","cardDetails","undefined","split","card","setCard","onDeletefromCard","item","cardCookies","cardArray","filter","word","remove","set","join","path","length","total_price","key","Number","onCreateOrder","wineList","push","email","method","body","JSON","stringify","headers","map","e","target","value","isNaN","slice","testArray","newEtargetValue"],"mappings":"8KAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAO,YAAP,CACA,OAASC,QAAT,CAAmBC,SAAnB,KAAoC,OAApC,CACA,MAAOC,CAAAA,OAAP,KAAoB,kBAApB,CACA,OAASC,eAAT,KAAgC,gCAAhC,CACA,OAASC,OAAT,KAAwB,mCAAxB,CACA,OAASC,KAAT,KAAsB,iBAAtB,C,wFAEA,GAAMC,CAAAA,IAAI,CAAG,QAAPA,CAAAA,IAAO,EAAM,CACjB,cAAoCN,QAAQ,CAAC,CAAD,CAA5C,wCAAOO,UAAP,eAAmBC,aAAnB,eACA,eAAsCR,QAAQ,CAAC,EAAD,CAA9C,yCAAOS,WAAP,eAAoBC,cAApB,eACA,eAA8BV,QAAQ,CAAC,EAAD,CAAtC,yCAAOW,OAAP,eAAgBC,UAAhB,eACA,eAAgCZ,QAAQ,CAAC,EAAD,CAAxC,yCAAOa,QAAP,eAAiBC,WAAjB,eACA,eAA8Bd,QAAQ,CAAC,EAAD,CAAtC,0CAAOe,OAAP,gBAAgBC,UAAhB,gBACA,gBAAqChB,QAAQ,CAAC,EAAD,CAA7C,2CAAOiB,WAAP,gBAAoBC,aAApB,gBACA,gBAAoClB,QAAQ,CAAC,EAAD,CAA5C,2CAAOmB,UAAP,gBAAmBC,aAAnB,gBACA,gBAAgCpB,QAAQ,CAAC,EAAD,CAAxC,2CAAOqB,QAAP,gBAAiBC,WAAjB,gBACA,gBAA8BtB,QAAQ,CAAC,EAAD,CAAtC,2CAAOuB,OAAP,gBAAgBC,UAAhB,gBAEA,GAAMC,CAAAA,OAAO,CAAG,GAAIvB,CAAAA,OAAJ,EAAhB,CACA,GAAIwB,CAAAA,SAAS,CAAGD,OAAO,CAACE,GAAR,CAAY,OAAZ,CAAhB,CACAC,OAAO,CAACC,GAAR,CAAYJ,OAAO,CAACE,GAAR,CAAY,MAAZ,CAAZ,EAEA;AACA,GAAMG,CAAAA,OAAO,CAAG,QAAVA,CAAAA,OAAU,EAAM,CACpBC,KAAK,yCAAkCL,SAAlC,EAAL,CACGM,IADH,CACQ,SAACC,GAAD,QAASA,CAAAA,GAAG,CAACC,IAAJ,EAAT,EADR,EAEGF,IAFH,CAEQ,SAACE,IAAD,CAAU,CACdN,OAAO,CAACC,GAAR,CAAYK,IAAI,CAACC,IAAjB,EACAvB,UAAU,CAACsB,IAAI,CAACC,IAAL,CAAUC,OAAX,CAAV,CACAtB,WAAW,CAACoB,IAAI,CAACC,IAAL,CAAUE,MAAX,CAAX,CACAnB,aAAa,CAAC,CAACgB,IAAD,CAAD,CAAb,CACD,CAPH,EAQD,CATD,CAUAjC,SAAS,CAAC,UAAM,CACd6B,OAAO,GACR,CAFQ,CAEN,EAFM,CAAT,CAIA,GAAIQ,CAAAA,WAAW,CACbb,OAAO,CAACE,GAAR,CAAY,MAAZ,IAAwB,EAAxB,EAA8BF,OAAO,CAACE,GAAR,CAAY,MAAZ,IAAwBY,SAAtD,CACI,EADJ,CAEId,OAAO,CAACE,GAAR,CAAY,MAAZ,EAAoBa,KAApB,CAA0B,GAA1B,CAHN,CAKA,gBAAwBxC,QAAQ,CAACsC,WAAD,CAAhC,2CAAOG,IAAP,gBAAaC,OAAb,gBAEA;AACA,GAAMC,CAAAA,gBAAgB,CAAG,QAAnBA,CAAAA,gBAAmB,CAACC,IAAD,CAAU,CACjC,GAAIC,CAAAA,WAAW,CAAGpB,OAAO,CAACE,GAAR,CAAY,MAAZ,CAAlB,CACA,GAAImB,CAAAA,SAAS,CAAGD,WAAW,CAACL,KAAZ,CAAkB,GAAlB,CAAhB,CACAM,SAAS,CAAGA,SAAS,CAACC,MAAV,CAAiB,SAACC,IAAD,QAAUA,CAAAA,IAAI,GAAKJ,IAAnB,EAAjB,CAAZ,CAEA,GAAIE,SAAS,GAAK,CAAC,EAAD,CAAlB,CAAwB,CACtBrB,OAAO,CAACwB,MAAR,CAAe,MAAf,EACA;AACAP,OAAO,CAAC,EAAD,CAAP,CACD,CAJD,IAIO,CACLjB,OAAO,CAACyB,GAAR,CAAY,MAAZ,CAAoBJ,SAAS,CAACK,IAAV,CAAe,GAAf,CAApB,CAAyC,CAAEC,IAAI,CAAE,GAAR,CAAzC,EACAV,OAAO,CAACI,SAAD,CAAP,CACD,CACF,CAbD,CAeA7C,SAAS,CAAC,UAAM,CACd,GAAIwC,IAAI,CAACY,MAAL,GAAgB,CAApB,CAAuB,CACrB7C,aAAa,CAAC,CAAD,CAAb,CACD,CAFD,IAEO,CACL,GAAI8C,CAAAA,WAAW,CAAG,CAAlB,CACA,IAAK,GAAMC,CAAAA,GAAX,GAAkBd,CAAAA,IAAlB,CAAwB,CACtBa,WAAW,CACTE,MAAM,CAACF,WAAD,CAAN,CACAE,MAAM,CAACf,IAAI,CAACc,GAAD,CAAJ,CAAUf,KAAV,CAAgB,GAAhB,EAAqB,CAArB,EAA0BC,IAAI,CAACc,GAAD,CAAJ,CAAUf,KAAV,CAAgB,GAAhB,EAAqB,CAArB,CAA3B,CAFR,CAGD,CACDhC,aAAa,CAAC8C,WAAD,CAAb,CACD,CACF,CAZQ,CAYN,CAACb,IAAD,CAZM,CAAT,CAcA,GAAMgB,CAAAA,aAAa,CAAG,QAAhBA,CAAAA,aAAgB,EAAM,CAC1B,GAAIC,CAAAA,QAAQ,CAAG,EAAf,CACA,IAAK,GAAMH,CAAAA,GAAX,GAAkBd,CAAAA,IAAlB,CAAwB,CACtBiB,QAAQ,CAACC,IAAT,CAAclB,IAAI,CAACc,GAAD,CAAJ,CAAUf,KAAV,CAAgB,GAAhB,EAAqB,CAArB,CAAd,EACD,CACD;AACA;AACA;AAEA,GAAIF,CAAAA,WAAW,CAAG,CAChBoB,QAAQ,CAAEA,QADM,CAEhBE,KAAK,CAAElC,SAFS,CAGhBnB,UAAU,CAAEA,UAHI,CAAlB,CAKAwB,KAAK,CAAC,qCAAD,CAAwC,CAC3C8B,MAAM,CAAE,MADmC,CAE3CC,IAAI,CAAEC,IAAI,CAACC,SAAL,CAAe1B,WAAf,CAFqC,CAG3C2B,OAAO,CAAE,CAAE,eAAgB,kBAAlB,CAHkC,CAAxC,CAAL,CAKGjC,IALH,CAKQ,SAACC,GAAD,QAASA,CAAAA,GAAG,CAACC,IAAJ,EAAT,EALR,EAMGF,IANH,CAMQ,SAACE,IAAD,CAAU,CACdN,OAAO,CAACC,GAAR,CAAYK,IAAZ,EACAT,OAAO,CAACwB,MAAR,CAAe,MAAf,EAEAP,OAAO,CAAC,EAAD,CAAP,CACD,CAXH,EAYD,CA1BD,CA4BA,mBACE,kCACE,aAAK,SAAS,CAAC,UAAf,wBACE,aAAK,SAAS,CAAC,sBAAf,wBACE,aAAK,SAAS,CAAC,oCAAf,wBACE,UAAG,SAAS,CAAC,uBAAb,EADF,cAEE,eACE;AACA,SAAS,CAAC,MAFZ,+BAFF,GADF,cAUE,aAVF,cAWE,WAAI,SAAS,CAAC,MAAd,2BAXF,CAaGD,IAAI,CAACY,MAAL,GAAgB,CAAhB,eACC,KAAC,KAAD,EAAO,SAAS,CAAC,YAAjB,CAA8B,OAAO,CAAC,SAAtC,gCAdJ,CAkBGZ,IAAI,CAACY,MAAL,GAAgB,CAAhB,eACC,oCACE,aAAK,SAAS,CAAC,gCAAf,wBACE,iDACW,0BAASZ,IAAI,CAACY,MAAd,YADX,mBADF,cAIE,2CAAuB9C,UAAvB,aAJF,GADF,CAQGkC,IAAI,CAACyB,GAAL,CAAS,SAACtB,IAAD,qBACR,aAAK,SAAS,CAAC,0EAAf,wBACE,aAAK,SAAS,CAAC,iBAAf,wBACE,UAAG,IAAI,iBAAWA,IAAI,CAACJ,KAAL,CAAW,GAAX,EAAgB,CAAhB,CAAX,CAAP,uBACE,YACE,SAAS,CAAC,WADZ,CAEE,GAAG,CAAEI,IAAI,CAACJ,KAAL,CAAW,GAAX,EAAgB,CAAhB,CAFP,CAGE,KAAK,CAAC,IAHR,EADF,EADF,6CASE,aAAK,SAAS,CAAC,MAAf,wBACE,aAAM,SAAS,CAAC,0BAAhB,UACGI,IAAI,CAACJ,KAAL,CAAW,GAAX,EAAgB,CAAhB,CADH,EADF,cAIE,cAAM,SAAS,CAAC,MAAhB,WACGI,IAAI,CAACJ,KAAL,CAAW,GAAX,EAAgB,CAAhB,CADH,OAC0BI,IAAI,CAACJ,KAAL,CAAW,GAAX,EAAgB,CAAhB,CAD1B,GAJF,GATF,GADF,cAmBE,aAAK,SAAS,CAAC,oCAAf,wBACE,aAAM,SAAS,CAAC,SAAhB,0BADF,CAIU,GAJV,sBAKS,aAAM,SAAS,CAAC,SAAhB,UAA2BI,IAAI,CAACJ,KAAL,CAAW,GAAX,EAAgB,CAAhB,CAA3B,EALT,cAME,uCANF,cAOE,cAAM,SAAS,CAAC,+BAAhB,WACGI,IAAI,CAACJ,KAAL,CAAW,GAAX,EAAgB,CAAhB,CADH,iBAPF,cAWE,cAAM,SAAS,CAAC,+BAAhB,wBACE,0BACGI,IAAI,CAACJ,KAAL,CAAW,GAAX,EAAgB,CAAhB,EAAqBI,IAAI,CAACJ,KAAL,CAAW,GAAX,EAAgB,CAAhB,CADxB,iBADF,qCAKE,KAAC,eAAD,EACE,SAAS,CAAC,YADZ,CAEE,OAAO,CAAE,kBAAM,CACbG,gBAAgB,CAACC,IAAD,CAAhB,CACD,CAJH,CAKE,IAAI,CAAExC,OALR,CAME,IAAI,CAAC,IANP,EALF,GAXF,GAnBF,GADQ,EAAT,CARH,GAnBJ,GADF,CAgFGa,WAAW,CAACoC,MAAZ,GAAuB,CAAvB,eACC,aAAK,SAAS,CAAC,UAAf,wBACE,aADF,cAEE,aAFF,oCAIE,aAJF,cAKE,aAAK,SAAS,CAAC,cAAf,2CAEE,aAAK,SAAS,CAAC,KAAf,wBACE,aAAK,SAAS,CAAC,UAAf,wBACE,cAAO,SAAS,CAAC,mBAAjB,+BADF,cAEE,cACE,IAAI,CAAC,MADP,CAEE,KAAK,CAAE1C,OAFT,CAGE,SAAS,CAAC,4BAHZ,CAIE,WAAW,CAAC,iBAJd,CAKE,QAAQ,CAAE,kBAACwD,CAAD,CAAO,CACfvD,UAAU,CAACuD,CAAC,CAACC,MAAF,CAASC,KAAV,CAAV,CACD,CAPH,EAFF,GADF,cAaE,aAAK,SAAS,CAAC,UAAf,wBACE,cAAO,SAAS,CAAC,mBAAjB,wBADF,cAEE,cACE,IAAI,CAAC,MADP,CAEE,SAAS,CAAC,4BAFZ,CAGE,WAAW,CAAC,OAHd,CAIE,QAAQ,CAAE,kBAACF,CAAD,CAAO,CACfnD,UAAU,CAACmD,CAAC,CAACC,MAAF,CAASC,KAAV,CAAV,CACD,CANH,EAFF,GAbF,CAwBGtD,OAAO,GAAK,EAAZ,EAAkBA,OAAO,CAACsC,MAAR,GAAmB,CAArC,eACC,UAAG,SAAS,CAAC,cAAb,2CAzBJ,cA2BE,aA3BF,cA4BE,aAAK,SAAS,CAAC,UAAf,wBACE,cAAO,SAAS,CAAC,mBAAjB,0BADF,cAEE,cACE,IAAI,CAAC,MADP,CAEE,KAAK,CAAExC,QAFT,CAGE,SAAS,CAAC,4BAHZ,CAIE,WAAW,CAAC,YAJd,CAKE,QAAQ,CAAE,kBAACsD,CAAD,CAAO,CACfrD,WAAW,CAACqD,CAAC,CAACC,MAAF,CAASC,KAAV,CAAX,CACD,CAPH,EAFF,GA5BF,CAyCGxD,QAAQ,GAAK,EAAb,GACEyD,KAAK,CAACzD,QAAD,CAAL,EACCA,QAAQ,CAACwC,MAAT,CAAkB,EADnB,EAECxC,QAAQ,CAACwC,MAAT,CAAkB,EAHrB,gBAIG,UAAG,SAAS,CAAC,cAAb,gCA7CN,GAFF,cAkDE,WAAI,SAAS,CAAC,MAAd,EAlDF,gCAoDE,oCACE,cAAO,SAAS,CAAC,mBAAjB,0BADF,cAEE,gBACE,SAAS,CAAC,4BADZ,CAEE,QAAQ,CAAE,kBAACc,CAAD,CAAO,CACfzD,cAAc,CAACyD,CAAC,CAACC,MAAF,CAASC,KAAV,CAAd,CACD,CAJH,wBAME,eAAQ,KAAK,CAAC,UAAd,6BANF,cAOE,eAAQ,KAAK,CAAC,SAAd,0BAPF,cAQE,eAAQ,KAAK,CAAC,MAAd,6BARF,GAFF,GApDF,CAiEG5D,WAAW,GAAK,MAAhB,eACC,oCACE,WAAI,SAAS,CAAC,MAAd,EADF,6BAGE,oCACE,cAAO,SAAS,CAAC,mBAAjB,yBADF,cAEE,cACE,IAAI,CAAC,MADP,CAEE,SAAS,CAAC,4BACV;AAHF,CAIE,KAAK,CAAEU,UAJT,CAKE,QAAQ,CAAE,kBAACgD,CAAD,CAAO,CACfvC,OAAO,CAACC,GAAR,CAAYsC,CAAC,CAACC,MAAF,CAASC,KAAT,CAAehB,MAA3B,EACA,GACE,CAAC,CAACiB,KAAK,CAACH,CAAC,CAACC,MAAF,CAASC,KAAT,CAAeF,CAAC,CAACC,MAAF,CAASC,KAAT,CAAehB,MAAf,CAAwB,CAAvC,CAAD,CAAN,EACCc,CAAC,CAACC,MAAF,CAASC,KAAT,GAAmB,EADrB,GAEAF,CAAC,CAACC,MAAF,CAASC,KAAT,CAAehB,MAAf,CAAwB,EAH1B,CAIE,CACAjC,aAAa,CAAC+C,CAAC,CAACC,MAAF,CAASC,KAAV,CAAb,CACD,CACF,CAdH,EAFF,GAHF,cAsBE,aAAK,SAAS,CAAC,KAAf,wBACE,aAAK,SAAS,CAAC,UAAf,wBACE,cAAO,SAAS,CAAC,mBAAjB,kBADF,cAEE,cACE,IAAI,CAAC,QADP,CAEE,KAAK,CACHhD,QAAQ,CAACgC,MAAT,EAAmB,CAAnB,CACIhC,QAAQ,CAACkD,KAAT,CAAe,CAAf,CAAkB,CAAlB,EAAuB,GAD3B,CAEIlD,QALR,CAOE,SAAS,CAAC,4BAPZ,CAQE,WAAW,CAAC,OARd,CASE,QAAQ,CAAE,kBAAC8C,CAAD,CAAO,CACf,GAAIA,CAAC,CAACC,MAAF,CAASC,KAAT,CAAehB,MAAf,CAAwB,CAA5B,CAA+B,CAC7B,GAAImB,CAAAA,SAAS,CAAGL,CAAC,CAACC,MAAF,CAASC,KAAT,CAAe7B,KAAf,CAAqB,GAArB,CAAhB,CACA,GAAIiC,CAAAA,eAAe,CAAG,EAAtB,CACA,IAAK,GAAMlB,CAAAA,GAAX,GAAkBiB,CAAAA,SAAlB,CAA6B,CAC3BC,eAAe,CACbA,eAAe,CAAGD,SAAS,CAACjB,GAAD,CAD7B,CAED,CACD3B,OAAO,CAACC,GAAR,CAAY4C,eAAZ,EACA,GAAI,CAACH,KAAK,CAACG,eAAD,CAAV,CAA6B,CAC3BnD,WAAW,CAAC6C,CAAC,CAACC,MAAF,CAASC,KAAV,CAAX,CACD,CACF,CACF,CAtBH,EAFF,GADF,cA4BE,aAAK,SAAS,CAAC,UAAf,wBACE,cAAO,SAAS,CAAC,mBAAjB,iBADF,cAEE,cACE,IAAI,CAAC,QADP,CAEE,SAAS,CAAC,4BAFZ,CAGE,WAAW,CAAC,KAHd,CAIE,KAAK,CAAE9C,OAJT,CAKE,QAAQ,CAAE,kBAAC4C,CAAD,CAAO,CACf,GACE,CAACG,KAAK,CAACH,CAAC,CAACC,MAAF,CAASC,KAAV,CAAN,EACAF,CAAC,CAACC,MAAF,CAASC,KAAT,CAAehB,MAAf,CAAwB,CAF1B,CAGE,CACA7B,UAAU,CAAC2C,CAAC,CAACC,MAAF,CAASC,KAAV,CAAV,CACD,CACF,CAZH,EAFF,GA5BF,GAtBF,GAlEJ,cAwIE,WAAI,SAAS,CAAC,MAAd,EAxIF,uBA0IE,aAAK,SAAS,CAAC,4CAAf,wBACE,kCADF,cAEE,4BAAQ9D,UAAR,aAFF,GA1IF,cA8IE,aAAK,SAAS,CAAC,4CAAf,wBACE,kCADF,cAEE,sBACGA,UAAU,CAAG,EAAb,EAAmBA,UAAU,GAAK,CAAlC,CAAsC,KAAtC,CAA8C,KADjD,EAFF,GA9IF,cAoJE,aAAK,SAAS,CAAC,4CAAf,wBACE,4CADF,cAEE,wBACGA,UAAU,CAAG,EAAb,EAAmBA,UAAU,GAAK,CAAlC,CACGA,UADH,CAEGA,UAAU,CAAG,CAHnB,CAGsB,GAHtB,YAFF,GApJF,cAkKE,eACE,QAAQ,CAAEkC,IAAI,CAACY,MAAL,GAAgB,CAD5B,CAEE,OAAO,CAAEI,aAFX,CAGE,SAAS,CAAC,+DAHZ,uBAME,sDACgB,UAAG,SAAS,CAAC,6BAAb,EADhB,GANF,EAlKF,GALF,GAjFJ,GADF,EADF,CA0QD,CAzWD,CA2WA,cAAenD,CAAAA,IAAf","sourcesContent":["import React from \"react\";\r\nimport \"./Card.css\";\r\nimport { useState, useEffect } from \"react\";\r\nimport Cookies from \"universal-cookie\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport { faTrash } from \"@fortawesome/free-solid-svg-icons\";\r\nimport { Alert } from \"react-bootstrap\";\r\n\r\nconst Card = () => {\r\n  const [totalPrice, setTotalPrice] = useState(0);\r\n  const [kindPayment, setKindPayment] = useState(\"\");\r\n  const [address, setAddress] = useState(\"\");\r\n  const [phoneNum, setPhoneNum] = useState(\"\");\r\n  const [zipCode, setZipCode] = useState(\"\");\r\n  const [userDetails, setUseretails] = useState([]);\r\n  const [cardNumber, setCardNumber] = useState(\"\");\r\n  const [cardDate, setCardDate] = useState(\"\");\r\n  const [cardCVV, setCardCVV] = useState(\"\");\r\n\r\n  const cookies = new Cookies();\r\n  var userEmail = cookies.get(\"email\");\r\n  console.log(cookies.get(\"card\"));\r\n\r\n  // ------------ Get user Details -----------------\r\n  const getUser = () => {\r\n    fetch(`http://localhost:4000/getUser/${userEmail}`)\r\n      .then((res) => res.json())\r\n      .then((json) => {\r\n        console.log(json.user);\r\n        setAddress(json.user.Address);\r\n        setPhoneNum(json.user.Mobile);\r\n        setUseretails([json]);\r\n      });\r\n  };\r\n  useEffect(() => {\r\n    getUser();\r\n  }, []);\r\n\r\n  var cardDetails =\r\n    cookies.get(\"card\") === \"\" || cookies.get(\"card\") === undefined\r\n      ? []\r\n      : cookies.get(\"card\").split(\"|\");\r\n\r\n  const [card, setCard] = useState(cardDetails);\r\n\r\n  // -------- Delete from Card ----------\r\n  const onDeletefromCard = (item) => {\r\n    var cardCookies = cookies.get(\"card\");\r\n    var cardArray = cardCookies.split(\"|\");\r\n    cardArray = cardArray.filter((word) => word !== item);\r\n\r\n    if (cardArray === [\"\"]) {\r\n      cookies.remove(\"card\");\r\n      // cookies.set(\"card\", undefined , { path: \"/\" });\r\n      setCard([]);\r\n    } else {\r\n      cookies.set(\"card\", cardArray.join(\"|\"), { path: \"/\" });\r\n      setCard(cardArray);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (card.length === 0) {\r\n      setTotalPrice(0);\r\n    } else {\r\n      var total_price = 0;\r\n      for (const key in card) {\r\n        total_price =\r\n          Number(total_price) +\r\n          Number(card[key].split(\",\")[5] * card[key].split(\",\")[7]);\r\n      }\r\n      setTotalPrice(total_price);\r\n    }\r\n  }, [card]);\r\n\r\n  const onCreateOrder = () => {\r\n    var wineList = [];\r\n    for (const key in card) {\r\n      wineList.push(card[key].split(\",\")[0]);\r\n    }\r\n    // console.log(totalPrice);\r\n    // console.log(userEmail);\r\n    // console.log(wineList)\r\n\r\n    let cardDetails = {\r\n      wineList: wineList,\r\n      email: userEmail,\r\n      totalPrice: totalPrice,\r\n    };\r\n    fetch(\"http://localhost:4000/completeOrder\", {\r\n      method: \"POST\",\r\n      body: JSON.stringify(cardDetails),\r\n      headers: { \"Content-Type\": \"application/json\" },\r\n    })\r\n      .then((res) => res.json())\r\n      .then((json) => {\r\n        console.log(json);\r\n        cookies.remove(\"card\");\r\n\r\n        setCard([]);\r\n      });\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <div className=\"cardboth\">\r\n        <div className=\"product-details mr-2\">\r\n          <div className=\"d-flex flex-row align-items-center\">\r\n            <i className=\"fa fa-long-arrow-left\"></i>\r\n            <button\r\n              //   style=\"padding: 0; border: none; background: none;\"\r\n              className=\"ml-2\"\r\n            >\r\n              Continue Shopping\r\n            </button>\r\n          </div>\r\n          <hr />\r\n          <h6 className=\"mb-0\">Shopping cart</h6>\r\n\r\n          {card.length === 0 && (\r\n            <Alert className=\"emptyAlert\" variant=\"warning\">\r\n              The Card is Empty!\r\n            </Alert>\r\n          )}\r\n          {card.length !== 0 && (\r\n            <div>\r\n              <div className=\"d-flex justify-content-between\">\r\n                <span>\r\n                  You have <strong>{card.length} items</strong> in your cart\r\n                </span>\r\n                <strong>Total Price : {totalPrice} €</strong>\r\n              </div>\r\n\r\n              {card.map((item) => (\r\n                <div className=\"d-flex justify-content-between align-items-center mt-3 p-2 items rounded\">\r\n                  <div className=\"d-flex flex-row\">\r\n                    <a href={`/wine/${item.split(\",\")[0]}`}>\r\n                      <img\r\n                        className=\"cardImage\"\r\n                        src={item.split(\",\")[6]}\r\n                        width=\"40\"\r\n                      />\r\n                    </a>\r\n                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n                    <div className=\"ml-2\">\r\n                      <span className=\"font-weight-bold d-block\">\r\n                        {item.split(\",\")[1]}\r\n                      </span>\r\n                      <span className=\"spec\">\r\n                        {item.split(\",\")[4]} , {item.split(\",\")[3]}\r\n                      </span>\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"d-flex flex-row align-items-center\">\r\n                    <span className=\"d-block\">\r\n                      {/* {formatDate(new Date(item.card.CardDate))}{\" \"} */}\r\n                      &nbsp;&nbsp;&nbsp;\r\n                    </span>{\" \"}\r\n                    &nbsp; <span className=\"d-block\">{item.split(\",\")[7]}</span>\r\n                    <strong>&nbsp; x &nbsp;</strong>\r\n                    <span className=\"d-block ml-5 font-weight-bold\">\r\n                      {item.split(\",\")[5]}\r\n                      &nbsp; = &nbsp;\r\n                    </span>\r\n                    <span className=\"d-block ml-5 font-weight-bold\">\r\n                      <strong>\r\n                        {item.split(\",\")[7] * item.split(\",\")[5]} &nbsp;€\r\n                      </strong>\r\n                      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n                      <FontAwesomeIcon\r\n                        className=\"deleteIcon\"\r\n                        onClick={() => {\r\n                          onDeletefromCard(item);\r\n                        }}\r\n                        icon={faTrash}\r\n                        size=\"1x\"\r\n                      />\r\n                    </span>\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {userDetails.length !== 0 && (\r\n          <div className=\"col-md-2\">\r\n            <br />\r\n            <br />\r\n            Continue with Order\r\n            <br />\r\n            <div className=\"payment-info\">\r\n              Personal Details\r\n              <div className=\"row\">\r\n                <div className=\"col-md-6\">\r\n                  <label className=\"credit-card-label\">Shipping location</label>\r\n                  <input\r\n                    type=\"text\"\r\n                    value={address}\r\n                    className=\"form-control credit-inputs\"\r\n                    placeholder=\"Atiki,Greece 31\"\r\n                    onChange={(e) => {\r\n                      setAddress(e.target.value);\r\n                    }}\r\n                  />\r\n                </div>\r\n                <div className=\"col-md-6\">\r\n                  <label className=\"credit-card-label\">Zip Number</label>\r\n                  <input\r\n                    type=\"text\"\r\n                    className=\"form-control credit-inputs\"\r\n                    placeholder=\"15231\"\r\n                    onChange={(e) => {\r\n                      setZipCode(e.target.value);\r\n                    }}\r\n                  />\r\n                </div>\r\n                {zipCode !== \"\" && zipCode.length !== 5 && (\r\n                  <p className=\"alertMessage\">Wrong Zip Code. Max length 5.</p>\r\n                )}\r\n                <br />\r\n                <div className=\"col-md-6\">\r\n                  <label className=\"credit-card-label\">Phone Number</label>\r\n                  <input\r\n                    type=\"text\"\r\n                    value={phoneNum}\r\n                    className=\"form-control credit-inputs\"\r\n                    placeholder=\"6999999999\"\r\n                    onChange={(e) => {\r\n                      setPhoneNum(e.target.value);\r\n                    }}\r\n                  />\r\n                </div>\r\n\r\n                {phoneNum !== \"\" &&\r\n                  (isNaN(phoneNum) ||\r\n                    phoneNum.length > 10 ||\r\n                    phoneNum.length < 10) && (\r\n                    <p className=\"alertMessage\">Wrong Phone Number</p>\r\n                  )}\r\n              </div>\r\n              <hr className=\"line\" />\r\n              Kind of Payment\r\n              <div>\r\n                <label className=\"credit-card-label\">Name on card</label>\r\n                <select\r\n                  className=\"form-control credit-inputs\"\r\n                  onChange={(e) => {\r\n                    setKindPayment(e.target.value);\r\n                  }}\r\n                >\r\n                  <option value=\"delivery\">Pay on delivery</option>\r\n                  <option value=\"deposit\">Bank deposit</option>\r\n                  <option value=\"card\">Payment by card</option>\r\n                </select>\r\n              </div>\r\n              {kindPayment === \"card\" && (\r\n                <div>\r\n                  <hr className=\"line\" />\r\n                  Card Details\r\n                  <div>\r\n                    <label className=\"credit-card-label\">Card number</label>\r\n                    <input\r\n                      type=\"text\"\r\n                      className=\"form-control credit-inputs\"\r\n                      // maxLength=\"19\"\r\n                      value={cardNumber}\r\n                      onChange={(e) => {\r\n                        console.log(e.target.value.length);\r\n                        if (\r\n                          (!isNaN(e.target.value[e.target.value.length - 1]) ||\r\n                            e.target.value === \"\") &&\r\n                          e.target.value.length < 16\r\n                        ) {\r\n                          setCardNumber(e.target.value);\r\n                        }\r\n                      }}\r\n                    />\r\n                  </div>\r\n                  <div className=\"row\">\r\n                    <div className=\"col-md-6\">\r\n                      <label className=\"credit-card-label\">Date</label>\r\n                      <input\r\n                        type=\"search\"\r\n                        value={\r\n                          cardDate.length == 2\r\n                            ? cardDate.slice(0, 2) + \"/\"\r\n                            : cardDate\r\n                        }\r\n                        className=\"form-control credit-inputs\"\r\n                        placeholder=\"12/24\"\r\n                        onChange={(e) => {\r\n                          if (e.target.value.length < 6) {\r\n                            var testArray = e.target.value.split(\"/\");\r\n                            var newEtargetValue = \"\";\r\n                            for (const key in testArray) {\r\n                              newEtargetValue =\r\n                                newEtargetValue + testArray[key];\r\n                            }\r\n                            console.log(newEtargetValue);\r\n                            if (!isNaN(newEtargetValue)) {\r\n                              setCardDate(e.target.value);\r\n                            }\r\n                          }\r\n                        }}\r\n                      />\r\n                    </div>\r\n                    <div className=\"col-md-6\">\r\n                      <label className=\"credit-card-label\">CVV</label>\r\n                      <input\r\n                        type=\"search\"\r\n                        className=\"form-control credit-inputs\"\r\n                        placeholder=\"342\"\r\n                        value={cardCVV}\r\n                        onChange={(e) => {\r\n                          if (\r\n                            !isNaN(e.target.value) &&\r\n                            e.target.value.length < 4\r\n                          ) {\r\n                            setCardCVV(e.target.value);\r\n                          }\r\n                        }}\r\n                      />\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              )}\r\n              <hr className=\"line\" />\r\n              Sumary\r\n              <div className=\"d-flex justify-content-between information\">\r\n                <span>Subtotal</span>\r\n                <span> {totalPrice} €</span>\r\n              </div>\r\n              <div className=\"d-flex justify-content-between information\">\r\n                <span>Shipping</span>\r\n                <span>\r\n                  {totalPrice > 50 || totalPrice === 0 ? \"0 €\" : \"3 €\"}\r\n                </span>\r\n              </div>\r\n              <div className=\"d-flex justify-content-between information\">\r\n                <span>Total(Incl. taxes)</span>\r\n                <span>\r\n                  {totalPrice > 50 || totalPrice === 0\r\n                    ? totalPrice\r\n                    : totalPrice + 3}{\" \"}\r\n                  €\r\n                </span>\r\n              </div>\r\n              {/* <input\r\n                    type=\"number\"\r\n                    name=\"totalPrice\"\r\n                    value=\"{{total_price}}\"\r\n                  /> */}\r\n              <button\r\n                disabled={card.length === 0}\r\n                onClick={onCreateOrder}\r\n                className=\"btn btn-primary btn-block d-flex justify-content-between mt-3\"\r\n              >\r\n               \r\n                <span>\r\n                  Complete Order<i className=\"fa fa-long-arrow-right ml-1\"></i>\r\n                </span>\r\n              </button>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Card;\r\n"]},"metadata":{},"sourceType":"module"}